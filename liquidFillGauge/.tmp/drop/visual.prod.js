function liquidFillGaugeDefaultSettings(){return{minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.05,waveCount:1,waveRiseTime:1e3,waveAnimateTime:18e3,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:0,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"}}function loadLiquidFillGauge(t,a,e){function i(){H.attr("transform","translate("+D(H.attr("T"))+",0)"),H.transition().duration(e.waveAnimateTime*(1-H.attr("T"))).ease("linear").attr("transform","translate("+D(1)+",0)").attr("T",1).each("end",function(){H.attr("T",0),i(e.waveAnimateTime)})}function n(){this.update=function(t){var a=parseFloat(t).toFixed(2),n=function(t){return Math.round(t)};parseFloat(a)!=parseFloat(n(a))&&(n=function(t){return parseFloat(t).toFixed(1)}),parseFloat(a)!=parseFloat(n(a))&&(n=function(t){return parseFloat(t).toFixed(2)});var s=function(){var a=d3.interpolate(this.textContent,parseFloat(t).toFixed(2));return function(t){this.textContent=n(a(t))+g}};E.transition().duration(e.waveRiseTime).tween("text",s),z.transition().duration(e.waveRiseTime).tween("text",s);var l,o=Math.max(e.minValue,Math.min(e.maxValue,t))/e.maxValue,u=w*r(100*o),d=d3.scale.linear().range([f+2*w+u,f-u]).domain([0,1]),c=d(o),v=d3.scale.linear().range([0,_]).domain([0,1]),p=d3.scale.linear().range([0,u]).domain([0,1]);l=e.waveHeightScaling?d3.svg.area().x(function(t){return v(t.x)}).y0(function(t){return p(Math.sin(2*Math.PI*e.waveOffset*-1+2*Math.PI*(1-e.waveCount)+2*t.y*Math.PI))}).y1(function(t){return 2*w+u}):G;var h=e.waveAnimate?D(1):0;H.transition().duration(0).transition().duration(e.waveAnimate?e.waveAnimateTime*(1-H.attr("T")):e.waveRiseTime).ease("linear").attr("d",l).attr("transform","translate("+h+",0)").attr("T","1").each("end",function(){e.waveAnimate&&(H.attr("transform","translate("+D(0)+",0)"),i(e.waveAnimateTime))}),q.transition().duration(e.waveRiseTime).attr("transform","translate("+U+","+c+")")}}null==e&&(e=liquidFillGaugeDefaultSettings());var r,s=d3.select("#"+t),l=Math.min(parseInt(s.style("width")),parseInt(s.style("height")))/2,o=parseInt(s.style("width"))/2-l,u=parseInt(s.style("height"))/2-l,d=Math.max(e.minValue,Math.min(e.maxValue,a))/e.maxValue;r=e.waveHeightScaling?d3.scale.linear().range([0,e.waveHeight,0]).domain([0,50,100]):d3.scale.linear().range([e.waveHeight,e.waveHeight]).domain([0,100]);var c=e.textSize*l/2,v=parseFloat(a).toFixed(2),p=e.valueCountUp?e.minValue:v,g=e.displayPercent?"%":"",h=e.circleThickness*l,m=e.circleFillGap*l,f=h+m,w=l-f,x=w*r(100*d),A=2*w/e.waveCount,F=1+e.waveCount,_=A*F,y=function(t){return Math.round(t)};parseFloat(v)!=parseFloat(y(v))&&(y=function(t){return parseFloat(t).toFixed(1)}),parseFloat(v)!=parseFloat(y(v))&&(y=function(t){return parseFloat(t).toFixed(2)});for(var C=[],T=0;T<=40*F;T++)C.push({x:T/(40*F),y:T/40});var V=d3.scale.linear().range([0,2*Math.PI]).domain([0,1]),B=d3.scale.linear().range([0,l]).domain([0,l]),I=d3.scale.linear().range([0,_]).domain([0,1]),P=d3.scale.linear().range([0,x]).domain([0,1]),M=d3.scale.linear().range([f+2*w+x,f-x]).domain([0,1]),D=d3.scale.linear().range([0,_-2*w]).domain([0,1]),b=d3.scale.linear().range([f+2*w,f+.7*c]).domain([0,1]),S=s.append("g").attr("transform","translate("+o+","+u+")"),R=d3.svg.arc().startAngle(V(0)).endAngle(V(1)).outerRadius(B(l)).innerRadius(B(l-h));S.append("path").attr("d",R).style("fill",e.circleColor).attr("transform","translate("+l+","+l+")");var E=S.append("text").text(y(p)+g).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",c+"px").style("fill",e.textColor).attr("transform","translate("+l+","+b(e.textVertPosition)+")"),G=d3.svg.area().x(function(t){return I(t.x)}).y0(function(t){return P(Math.sin(2*Math.PI*e.waveOffset*-1+2*Math.PI*(1-e.waveCount)+2*t.y*Math.PI))}).y1(function(t){return 2*w+x}),q=S.append("defs").append("clipPath").attr("id","clipWave"+t),H=q.append("path").datum(C).attr("d",G).attr("T",0),N=S.append("g").attr("clip-path","url("+location.href+"#clipWave"+t+")");N.append("circle").attr("cx",l).attr("cy",l).attr("r",w).style("fill",e.waveColor);var z=N.append("text").text(y(p)+g).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",c+"px").style("fill",e.waveTextColor).attr("transform","translate("+l+","+b(e.textVertPosition)+")");if(e.valueCountUp){var O=function(){var t=d3.interpolate(this.textContent,v);return function(a){this.textContent=y(t(a))+g}};E.transition().duration(e.waveRiseTime).tween("text",O),z.transition().duration(e.waveRiseTime).tween("text",O)}var U=f+2*w-_;return e.waveRise?q.attr("transform","translate("+U+","+M(0)+")").transition().duration(e.waveRiseTime).attr("transform","translate("+U+","+M(d)+")").each("start",function(){H.attr("transform","translate(1,0)")}):q.attr("transform","translate("+U+","+M(d)+")"),e.waveAnimate&&i(),new n}var powerbi;!function(t){var a;!function(t){var a;!function(t){var a;!function(t){var a=function(){function t(t){console.log("Visual constructor",t),this.target=t.element;var a="http://www.w3.org/2000/svg";this.svg=document.createElementNS(a,"svg"),this.svg.setAttributeNS(null,"id",this.target.className+"_gauge");var e=parseInt(this.target.style.width),i=parseInt(this.target.style.height);this.svg.setAttributeNS(null,"viewBox","0 0 "+e+" "+i),this.svg.setAttributeNS(null,"width",this.target.style.width),this.svg.setAttributeNS(null,"height",this.target.style.height),this.target.appendChild(this.svg)}return t.prototype.update=function(t){console.log("Visual update",t);var a=t.dataViews[0];if(a){var e=a.single.value;e>=0&&(this.gauge?this.gauge.update(e):this.gauge=loadLiquidFillGauge(this.svg.id,e,liquidFillGaugeDefaultSettings()))}},t.prototype.destroy=function(){},t}();t.Visual=a}(a=t.PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028||(t.PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028={}))}(a=t.visual||(t.visual={}))}(a=t.extensibility||(t.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(t){var a;!function(a){var e;!function(a){a.PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028={name:"PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028",displayName:"liquidFillGauge",class:"Visual",version:"1.0.0",apiVersion:"1.1.0",create:function(a){return new t.extensibility.visual.PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028.Visual(a)},custom:!0}}(e=a.plugins||(a.plugins={}))}(a=t.visuals||(t.visuals={}))}(powerbi||(powerbi={}));